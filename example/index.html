<!doctype html>
<html>
    <head>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js"></script>

        <!-- Import WebGL Layer and Dependencies. -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/4.0.0/pixi.min.js"></script>
        <script src="./CanvasLayer.js"></script>
        <script src="../src/PixiLayer.js"></script>

        <style type="text/css">
            html, body, #map-canvas {
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }
            #map-canvas {
                position: relative;
            }
        </style>
    </head>
    <body>
        <div id="map-canvas"></div>

        <script type="text/javascript">
            $(document).ready(function() {
                var mapOptions = {
                    center: { lat: 34.0522, lng: -118.2437},
                    zoom: 5
                };
                var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
                function initialize() {
                    var myLayer;
                    myLayer = new PixiLayer(map, true);
                    myLayer.addLayer((layer, mapProjection) => {
                        let point = { lat: 34.0522, lng: -118.2437 };
                        let convertedPoint = mapProjection.fromLatLngToPoint(new google.maps.LatLng(point));

                        var graphics = new PIXI.Graphics();
                        graphics.beginFill(0xFF0000);
                        graphics.lineStyle(1, 0xFFFF00);

                        graphics.drawRect(convertedPoint.x, convertedPoint.y, 1, 1);
                        layer.addChild(graphics);
                        console.log("Adding Layer");
                    });
                }
                google.maps.event.addDomListener(map, 'idle', initialize);
            });
        </script>
    </body>
</html>